---
layout: post
title: GVRNN
subtitle: Graph Variational Recurrent Neural Networks
---

ì´ê²ƒì€ 2022 MLSA Workshopì— ì œì¶œí•œ "Evaluation of creating scoring opportunities for teammates in soccer via trajectory prediction"ë…¼ë¬¸ì„ ë°”íƒ•ìœ¼ë¡œ ì œê°€ ê³µë¶€í•œ GVRNNì— ëŒ€í•œ ì„¤ëª…ì…ë‹ˆë‹¤.

- ìœ„ ë…¼ë¬¸ì€ GVRNNì„ í™œìš©í•˜ì—¬ ì„ ìˆ˜ë“¤ì˜ trajectoryë¥¼ ì˜ˆì¸¡í•˜ëŠ” ë¬¸ì œë¥¼ ë‹¤ë£¨ê³  ìˆìŠµë‹ˆë‹¤. ë…¼ë¬¸ì— ëŒ€í•´ì„œëŠ” ë³¸ blogì—ì„œ ì„¤ëª…í•˜ì§€ ì•Šê³  GVRNNì— ëŒ€í•´ì„œë§Œ ì„¤ëª…í•©ë‹ˆë‹¤. 
- GVRNNì„ ì„¤ëª…í•˜ë ¤ë©´, ê²°êµ­ AE(AutoEncoder), VAE(Variational AutoEncoder), VRNN(Variational Recurrent Neural Network), GNN(Graph Neural Network)ë¥¼ ëª¨ë‘ ì•Œì•„ì•¼í•œë‹¤. GVRNNì€ VRNNê³¼ GNNë¥¼ í™œìš©í•œ ê¸°ë²•ì´ë¯€ë¡œ 4ê°€ì§€ íŠ¹ì§•ì„ ëª¨ë‘ ì•ˆë‹¤ë©´, GVRNNë¥¼ ì´í•´í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.
- 4ê°€ì§€ ê°œë…ì„ í•˜ë‚˜ì˜ blogì— ë‹´ìœ¼ë ¤ë©´ ìš”ì•½ëœ ì •ë³´ë§Œì„ ì„¤ëª…í•  ìˆ˜ ë°–ì— ì—†ë‹¤. ë‚˜ì¤‘ì— ì¡°ê¸ˆ ë” ìì„¸íˆ ì“¸ ê³„íšì´ë‹¤.

### AE(AutoEncoder)
- ì˜¤í† ì¸ì½”ë”(AE)ëŠ” ì…ë ¥ ë°ì´í„°ë¥¼ ì••ì¶•í•œ í›„ ë³µì›í•˜ì—¬ representation learning(ë°ì´í„°ì˜ í‘œí˜„ì„ í•™ìŠµ)í•˜ëŠ” ë¹„ì§€ë„ í•™ìŠµ ì•Œê³ ë¦¬ì¦˜ì´ë‹¤.
- Encoder : ì…ë ¥ ë°ì´í„°ë¥¼ ë‚´ë¶€ í‘œí˜„(ì ì¬ ê³µê°„)ìœ¼ë¡œ ë³€í™˜ -> ì¶”ì¶œëœ íŠ¹ì§•ì„ Latent Vectorë¼ê³  ë¶€ë¦„
- Decoder : Encoderë¥¼ ê±°ì¹œ Latent Spaceë¥¼ ë°›ì•„ ì›ë³¸ ë°ì´í„°ê³¼ ê°™ì€ í˜•íƒœë¡œ ì¬êµ¬ì„±
- Model code github : [Model](https://github.com/dariocazzani/pytorch-AE/blob/master/models/AE.py)
  
![Model](https://blog.kakaocdn.net/dn/8JonH/btqFBec9cAF/mhxdDF930R0CrHs9NdUKv1/img.png)
  
### VAE(Variational AutoEncoder)
- ë³€ì´í˜• ì˜¤í† ì¸ì½”ë”(VAE)ëŠ” AEê³¼ ë¹„ìŠ·í•œ êµ¬ì¡°ë¥¼ ê°€ì§€ì§€ë§Œ, í™•ë¥  ë¶„í¬ë¥¼ ëª¨ë¸ë§í•œë‹¤ëŠ” ì ì—ì„œ ì°¨ì´ê°€ ìˆë‹¤
- Encoder : ì…ë ¥ ë°ì´í„°ë¥¼ ë‚´ë¶€ í‘œí˜„(ì ì¬ ê³µê°„)ìœ¼ë¡œ ë³€í™˜ -> í™•ë¥  ë¶„í¬ë¥¼ ì •ì˜í•˜ëŠ” í‰ê· ê³¼ í‘œì¤€í¸ì°¨ ì¶œë ¥
- Latent Space : AEê³¼ ë‹¤ë¥´ê²Œ VAEì—ì„œëŠ” Latent Spaceì—ì„œ noiseë¥¼ ì¶”ê°€í•¨(ë™ì¼í•œ ë°ì´í„° ìƒì„± ë°©ì§€) -> ì •ê·œë¶„í¬ë¡œ ë¶€í„° í•˜ë‚˜ì˜ noiseë¥¼ ìƒ˜í”Œë§í•œ í›„ ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ Latent vector zë¥¼ ì–»ëŠ”ë°, ì´ë¥¼ reparameterizeì´ë¼ í•œë‹¤.
- Decoder : Latend Spaceë¥¼ ê±°ì¹œ zë¥¼ ë°›ì•„ ì›ë³¸ ë°ì´í„°ê³¼ ê°™ì€ í˜•íƒœë¡œ ì¬êµ¬ì„±
- Model code github : [Model](https://github.com/emited/VariationalRecurrentNeuralNetwork/blob/master/model.py)
  
![Model](https://blog.kakaocdn.net/dn/b30Uzl/btrxY4wKngj/SucVwitDrRtQvi1xTHdrR0/img.png)

### VRNN
- RNNì˜ ì‹œê°„ì  ë™ì  íŠ¹ì„±ê³¼ VAEì˜ í™•ë¥ ì  ìƒì„± ëª¨ë¸ë§ë¥¼ ê²°í•©í–ˆë‹¤. ì‹œê°„ì— ë”°ë¼ ë³€í™”í•˜ëŠ” Trajectoryë¥¼ íš¨ê³¼ì ìœ¼ë¡œ í•™ìŠµí•˜ê¸° ìœ„í•´ì„œ RNNë„ì…
- Prior : $$ğ‘_ğœƒ (ğ‘§_ğ‘¡â”‚ğ‘¥_(<ğ‘¡), ğ‘§_(<ğ‘¡) )= ğœ‘_ğ‘ğ‘Ÿğ‘–ğ‘œğ‘Ÿ (â„_(ğ‘¡âˆ’1))$$

- Latent Space : AEê³¼ ë‹¤ë¥´ê²Œ VAEì—ì„œëŠ” Latent Spaceì—ì„œ noiseë¥¼ ì¶”ê°€í•¨(ë™ì¼í•œ ë°ì´í„° ìƒì„± ë°©ì§€) -> ì •ê·œë¶„í¬ë¡œ ë¶€í„° í•˜ë‚˜ì˜ noiseë¥¼ ìƒ˜í”Œë§í•œ í›„ ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ Latent vector zë¥¼ ì–»ëŠ”ë°, ì´ë¥¼ reparameterizeì´ë¼ í•œë‹¤.
- Encoder : ì…ë ¥ ë°ì´í„°ë¥¼ ë‚´ë¶€ í‘œí˜„(ì ì¬ ê³µê°„)ìœ¼ë¡œ ë³€í™˜ -> ì¶”ì¶œëœ íŠ¹ì§•ì„ Latent Spaceë¼ê³  ë¶€ë¦„
- Decoder : Encoderë¥¼ ê±°ì¹œ Latent Spaceë¥¼ ë°›ì•„ ì›ë³¸ ë°ì´í„°ê³¼ ê°™ì€ í˜•íƒœë¡œ ì¬êµ¬ì„±
- Model code link : ![Model](https://github.com/dariocazzani/pytorch-AE/blob/master/models/AE.py)
  
![Model](https://blog.kakaocdn.net/dn/8JonH/btqFBec9cAF/mhxdDF930R0CrHs9NdUKv1/img.png)

### GVRNN
- ì˜¤í† ì¸ì½”ë”(AE)ëŠ” ì…ë ¥ ë°ì´í„°ë¥¼ ì••ì¶•í•œ í›„ ë³µì›í•˜ì—¬ representation learning(ë°ì´í„°ì˜ í‘œí˜„ì„ í•™ìŠµ)í•˜ëŠ” ë¹„ì§€ë„ í•™ìŠµ ì•Œê³ ë¦¬ì¦˜ì´ë‹¤.
- Encoder : ì…ë ¥ ë°ì´í„°ë¥¼ ë‚´ë¶€ í‘œí˜„(ì ì¬ ê³µê°„)ìœ¼ë¡œ ë³€í™˜ -> ì¶”ì¶œëœ íŠ¹ì§•ì„ Latent Spaceë¼ê³  ë¶€ë¦„
- Decoder : Encoderë¥¼ ê±°ì¹œ Latent Spaceë¥¼ ë°›ì•„ ì›ë³¸ ë°ì´í„°ê³¼ ê°™ì€ í˜•íƒœë¡œ ì¬êµ¬ì„±
- Model code link : ![Model](https://github.com/dariocazzani/pytorch-AE/blob/master/models/AE.py)
  
![Model](https://blog.kakaocdn.net/dn/8JonH/btqFBec9cAF/mhxdDF930R0CrHs9NdUKv1/img.png)

