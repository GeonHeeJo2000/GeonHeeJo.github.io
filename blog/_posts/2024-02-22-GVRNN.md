---
layout: post
title: GVRNN
subtitle: Graph Variational Recurrent Neural Networks
---

이것은 2022 MLSA Workshop에 제출한 "Evaluation of creating scoring opportunities for teammates in soccer via trajectory prediction"논문을 바탕으로 제가 공부한 GVRNN에 대한 설명입니다.

- 위 논문은 GVRNN을 활용하여 선수들의 trajectory를 예측하는 문제를 다루고 있습니다. 논문에 대해서는 본 blog에서 설명하지 않고 GVRNN에 대해서만 설명합니다. 
- GVRNN을 설명하려면, 결국 AE(AutoEncoder), VAE(Variational AutoEncoder), RNN(Recurrent Neural Network), VRNN(Variational Recurrent Neural Network), GNN(Graph Neural Network)를 모두 알아야한다. GVRNN은 VRNN과 GNN를 활용한 기법이므로 5가지 특징을 모두 안다면, GVRNN를 이해할 수 있을 것이다.
- 5가지 개념을 하나의 blog에 담으려면 요약된 정보만을 설명할 수 밖에 없다. 나중에 조금 더 자세히 쓸 계획이다.

### AE(AutoEncoder)
- 오토인코더(AE)는 입력 데이터를 압축한 후 복원하여 representation learning(데이터의 표현을 학습)하는 비지도 학습 알고리즘이다.
- Encoder : 입력 데이터를 내부 표현(잠재 공간)으로 변환 -> 추출된 특징을 Latent Vector라고 부름
- Decoder : Encoder를 거친 Latent Space를 받아 원본 데이터과 같은 형태로 재구성
- Model code github : [Model](https://github.com/dariocazzani/pytorch-AE/blob/master/models/AE.py)
  
![Model](https://blog.kakaocdn.net/dn/8JonH/btqFBec9cAF/mhxdDF930R0CrHs9NdUKv1/img.png)
  
### VAE(Variational AutoEncoder)
- 변이형 오토인코더(VAE)는 AE과 비슷한 구조를 가지지만, 확률 분포를 모델링한다는 점에서 차이가 있다
- Encoder : 입력 데이터를 내부 표현(잠재 공간)으로 변환 -> 확률 분포를 정의하는 평균과 표준편차 출력
- Latent Space : AE과 다르게 VAE에서는 Latent Space에서 noise를 추가함(동일한 데이터 생성 방지) -> 정규분포로 부터 하나의 noise를 샘플링한 후 이를 바탕으로 Latent vector z를 얻는데, 이를 reparameterize이라 한다.
- Decoder : Latend Space를 거친 z를 받아 원본 데이터과 같은 형태로 재구성
- Model code github : [Model](https://github.com/dariocazzani/pytorch-AE/blob/master/models/VAE.py)
  
![Model](https://blog.kakaocdn.net/dn/b30Uzl/btrxY4wKngj/SucVwitDrRtQvi1xTHdrR0/img.png)


### RNN
- 오토인코더(AE)는 입력 데이터를 압축한 후 복원하여 representation learning(데이터의 표현을 학습)하는 비지도 학습 알고리즘이다.
- Encoder : 입력 데이터를 내부 표현(잠재 공간)으로 변환 -> 추출된 특징을 Latent Space라고 부름
- Decoder : Encoder를 거친 Latent Space를 받아 원본 데이터과 같은 형태로 재구성
- Model code link : ![Model](https://github.com/dariocazzani/pytorch-AE/blob/master/models/AE.py)
  
![Model](https://blog.kakaocdn.net/dn/8JonH/btqFBec9cAF/mhxdDF930R0CrHs9NdUKv1/img.png)
### Data Imbalance
- 축구는 득점/실점이 매우 적은 스포츠이므로 VAEP의 라벨 특성상 데이터 불균형문제는 불가피한다. 기존 논문에서 사용한 Boosting기반의 알고리즘은 데이터 불균형을 자체적으로 해결하기 때문에 문제가 없었지만, 딥러닝은 이 문제를 해결해줘야한다. 그래서 본 연구에서는 데이터 불균형 문제를 해결하기 위해 오버샘플링을 활용한다. 실제로 불균형 문제를 해결했을 때, 딥러닝의 성능도 더 좋아지는 것을 확인할 수 있다.
  
![Count](../assets/img/DataCount.jpg)
  
### VRNN
- 오토인코더(AE)는 입력 데이터를 압축한 후 복원하여 representation learning(데이터의 표현을 학습)하는 비지도 학습 알고리즘이다.
- Encoder : 입력 데이터를 내부 표현(잠재 공간)으로 변환 -> 추출된 특징을 Latent Space라고 부름
- Decoder : Encoder를 거친 Latent Space를 받아 원본 데이터과 같은 형태로 재구성
- Model code link : ![Model](https://github.com/dariocazzani/pytorch-AE/blob/master/models/AE.py)
  
![Model](https://blog.kakaocdn.net/dn/8JonH/btqFBec9cAF/mhxdDF930R0CrHs9NdUKv1/img.png)

### GVRNN
- 오토인코더(AE)는 입력 데이터를 압축한 후 복원하여 representation learning(데이터의 표현을 학습)하는 비지도 학습 알고리즘이다.
- Encoder : 입력 데이터를 내부 표현(잠재 공간)으로 변환 -> 추출된 특징을 Latent Space라고 부름
- Decoder : Encoder를 거친 Latent Space를 받아 원본 데이터과 같은 형태로 재구성
- Model code link : ![Model](https://github.com/dariocazzani/pytorch-AE/blob/master/models/AE.py)
  
![Model](https://blog.kakaocdn.net/dn/8JonH/btqFBec9cAF/mhxdDF930R0CrHs9NdUKv1/img.png)

